<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VisionWay — Resultado</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body data-page="result">
  <header class="topbar">
    <h1>VisionWay</h1>
    <nav class="nav">
      <a href="upload.html" class="nav-btn">Upload</a>
      <a href="history.html" class="nav-btn">Histórico</a>
    </nav>
  </header>

  <main class="screen">
    <div class="card result-card">
      <h2>Resultado</h2>
      <div class="result-container">
        <img id="result-img" alt="Resultado do reconhecimento" class="result-img"/>
      </div>
      <div class="result-info">
        <p id="meta"></p>
        <ul id="labels" class="labels"></ul>
      </div>
      <div class="actions">
        <a href="upload.html" class="btn">Enviar nova imagem</a>
        <a href="history.html" class="btn btn-outline">Ver histórico</a>
      </div>
      <p id="fallback" class="status" style="display:none;">
        Nenhum resultado encontrado. Faça um upload para começar.
      </p>
    </div>
  </main>

  <script>
    const img  = document.getElementById("result-img");
    const meta = document.getElementById("meta");
    const labelsUl = document.getElementById("labels");
    const fallback = document.getElementById("fallback");

    let data = JSON.parse(sessionStorage.getItem("vw_last") || "null");

    if (!data) {
      img.style.display = "none";
      meta.textContent = "";
      labelsUl.innerHTML = "";
      fallback.style.display = "block";
    } else {
      img.src = data.image;
      meta.textContent = `Detectados: ${data.count} • ${new Date(data.timestamp).toLocaleString("pt-BR")}`;
      labelsUl.innerHTML = data.detections && data.detections.length
        ? data.detections.map(d => `<li class="tag">${d.label}</li>`).join("")
        : `<li class="tag">—</li>`;
    }
  </script>
</body>
</html>
